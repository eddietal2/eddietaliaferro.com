"use strict";(self.webpackChunkeddietaliaferro_com=self.webpackChunkeddietaliaferro_com||[]).push([[1106],{1106:function(t,e,o){o.r(e),o.d(e,{EditProjectsPageModule:function(){return T}});var i=o(8583),n=o(665),r=o(7823),a=o(1382),s=o(4762),l=o(5304),c=o(5917),u=o(8720),d=o(4439),h=o(7775),m=o(1311);function g(t,e){if(1&t&&u._UZ(0,"img",14),2&t){const t=u.oxw();u.s9C("src",t.thumbnailDataURL,u.LSH)}}function p(t,e){if(1&t&&u._UZ(0,"img",14),2&t){const t=u.oxw();u.s9C("src",t.editProjectForm.value.thumbnail,u.LSH)}}const b=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,r,a){this.activatedRoute=t,this.router=e,this.formBuilder=o,this.toastController=i,this.projectService=n,this.adminBlogEmitterService=r,this.picturesService=a}ngOnInit(){const t=this.activatedRoute.snapshot.paramMap.get("id");this.id=t,this.editProjectForm=this.formBuilder.group({title:["",[n.kI.required]],thumbnail:["",[n.kI.required]],url:["",n.kI.required],description:["",n.kI.required]}),this.projectService.getProjectInfo(t).subscribe(t=>{console.log(t),new Promise((e,o)=>{var i=new XMLHttpRequest;i.open("GET",t.thumbnail,!0),i.responseType="blob",i.onload=function(){var t=new FileReader;console.log(typeof i.response),t.readAsDataURL(i.response),t.onload=function(t){let i=t.target.result.toString().replace("data:application/octet-stream","data:image/png");e(i),o("Something bad happened")}},i.send()}).then(t=>{this.thumbnailDataURL=t}),this.editProjectForm.patchValue({title:t.title,description:t.description,url:t.url})})}back(){this.router.navigateByUrl("/admin/projects")}getThumbnailFile(t){this.editProjectForm.value.thumbnail="";const e=document.getElementById("thumbnail");let o=new FileReader;e&&o.readAsDataURL(t.target.files[0]),o.addEventListener("load",()=>{this.thumbnailDataURL=o.result,console.log(this.thumbnailDataURL)},!1)}dataURLtoBlob(t){const e=t.split(","),o=e[0].match(/:(.*?);/)[1],i=atob(e[1]);let n=i.length;const r=new Uint8Array(n);for(;n--;)r[n]=i.charCodeAt(n);return new Blob([r],{type:o})}notTitleToast(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"There was no Title",cssClass:"danger-toast",position:"top",duration:2e3})).present()})}notThumbnailToast(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"There was no Thumbnail",cssClass:"danger-toast",position:"top",duration:2e3})).present()})}errorToast(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"There was an Error",cssClass:"danger-toast",position:"top",duration:2e3})).present()})}noProjectLinkToast(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"There was no Blog Toast",cssClass:"danger-toast",position:"top",duration:2e3})).present()})}noProjectDescriptionToast(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"There was no Blog Toast",cssClass:"danger-toast",position:"top",duration:2e3})).present()})}successfullProjectSubmit(){return(0,s.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"Successfully added Blog!",cssClass:"success-toast",position:"top",duration:2e3})).present()})}submitEdittedProject(){console.log("Getting Thumbnail S3 URL");const t=new FormData;let e=new File([this.dataURLtoBlob(this.thumbnailDataURL)],"thumbnail.png");t.append("blog-thumbnail",e),this.picturesService.blogThumbnailUpload(t).subscribe(t=>{if(this.thumbnailDataURL="",this.editProjectForm.value.thumbnail=t.objectUrl,!this.editProjectForm.value.title)return console.log("There was no Title"),this.notTitleToast();if(!this.editProjectForm.value.thumbnail)return console.log("There was no Thumbnail"),this.notThumbnailToast();if(!this.editProjectForm.value.description)return console.log("There was no Blog Description"),this.noProjectDescriptionToast();if(!this.editProjectForm.value.url)return console.log("There was no Project Link"),this.noProjectLinkToast();let e={id:this.id,title:this.editProjectForm.value.title,thumbnail:this.editProjectForm.value.thumbnail,url:this.editProjectForm.value.url,description:this.editProjectForm.value.description};console.log(e),this.projectService.editProject(e).pipe((0,l.K)(t=>{throw this.errorToast(),(0,c.of)(`I caught: ${t.error}`),Error(t)})).subscribe(t=>(0,s.mG)(this,void 0,void 0,function*(){console.log(t),yield this.adminBlogEmitterService.resetAdminBlogs(),yield this.successfullProjectSubmit(),yield this.router.navigateByUrl("admin/projects")}))})}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(a.gz),u.Y36(a.F0),u.Y36(n.qu),u.Y36(r.yF),u.Y36(d.Y),u.Y36(h.b),u.Y36(m.G))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-edit-projects"]],decls:29,vars:3,consts:[[2,"height","50px"],[1,"ion-justify-content-center"],["id","header-button","size-lg","8"],["slot","end"],[1,"purple-button",2,"--border-radius","50px",3,"click"],["size-lg","8"],[3,"formGroup","ngSubmit"],[2,"margin-top","0em"],["placeholder","Title","formControlName","title","type","text"],["placeholder","Link URL","formControlName","url","type","text"],["id","thumbnail","placeholder","Thumbnail","formControlName","thumbnail","type","file",3,"change"],["height","200","class","picture-preview",3,"src",4,"ngIf"],["rows","10","placeholder","Description of project","formControlName","description"],["type","submit",1,"green-button",2,"margin","5em auto 10em auto"],["height","200",1,"picture-preview",3,"src"]],template:function(t,e){1&t&&(u.TgZ(0,"ion-content"),u.TgZ(1,"ion-grid"),u._UZ(2,"ion-row",0),u.TgZ(3,"ion-row",1),u.TgZ(4,"ion-col",2),u.TgZ(5,"ion-toolbar"),u.TgZ(6,"ion-title"),u._uU(7,"Edit Project"),u.qZA(),u.TgZ(8,"ion-buttons",3),u.TgZ(9,"ion-button",4),u.NdJ("click",function(){return e.back()}),u._uU(10," Back "),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(11,"ion-col",5),u.TgZ(12,"form",6),u.NdJ("ngSubmit",function(){return e.submitEdittedProject()}),u.TgZ(13,"h4",7),u._uU(14,"Title"),u.qZA(),u._UZ(15,"ion-input",8),u.TgZ(16,"h4"),u._uU(17,"Link"),u.qZA(),u._UZ(18,"ion-input",9),u.TgZ(19,"h4"),u._uU(20,"Thumbnail"),u.qZA(),u.TgZ(21,"input",10),u.NdJ("change",function(t){return e.getThumbnailFile(t)}),u.qZA(),u.YNc(22,g,1,1,"img",11),u.YNc(23,p,1,1,"img",11),u.TgZ(24,"h4"),u._uU(25,"Description"),u.qZA(),u._UZ(26,"ion-textarea",12),u.TgZ(27,"ion-button",13),u._uU(28," Submit "),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&t&&(u.xp6(12),u.Q6J("formGroup",e.editProjectForm),u.xp6(10),u.Q6J("ngIf",e.thumbnailDataURL),u.xp6(1),u.Q6J("ngIf",e.editProjectForm.value.thumbnail))},directives:[r.W2,r.jY,r.Nd,r.wI,r.sr,r.wd,r.Sm,r.YG,n._Y,n.JL,n.sg,r.pK,r.j9,n.JJ,n.u,n.Fj,i.O5,r.g2],styles:["ion-grid[_ngcontent-%COMP%]{background-image:url(Matrix-Background.4d89e68e49e74a3df462.svg);background-attachment:fixed;background-size:cover;--color: white;height:auto}@media only screen and (max-width: 600px){ion-grid[_ngcontent-%COMP%]{background-image:url(Matrix-Background-Mobile.40092d82ecc24a826f9a.svg);background-size:cover;background-repeat:no-repeat}}form[_ngcontent-%COMP%]{padding:1em}ion-toolbar[_ngcontent-%COMP%]{margin-bottom:2.5em;--background: none;border-bottom:1px solid #333}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{position:relative;left:-20px}.purple-button[_ngcontent-%COMP%]{width:150px;display:block;margin:30px 0;--background: linear-gradient(360deg, #BC3790 -2%, #87005a, #BC3790);--color: white;--border-radius: 50px;--box-shadow: none}ion-input[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%]{background:#fff;--color: #333;--placeholder-color: #333;margin:1em 0;border-radius:5px;box-shadow:1px 1px 10px #333}ion-input[_ngcontent-%COMP%]{--padding-start: .5em;height:50px}h4[_ngcontent-%COMP%]{margin-top:3.5em;color:#d8cca8}.green-button[_ngcontent-%COMP%]{margin-top:3em;margin-bottom:10em}"]}),t})()}];let f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[a.Bz.forChild(b)],a.Bz]}),t})(),T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[i.ez,n.u5,n.UX,r.Pc,f]]}),t})()}}]);